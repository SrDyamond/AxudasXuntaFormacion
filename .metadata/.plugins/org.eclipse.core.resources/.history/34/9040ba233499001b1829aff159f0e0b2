package com.fp.conecction;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class conecctbd {
	private static final String DATABASE_DRIVER = "com.mysql.cj.jdbc.Driver";
	private static final String DATABASE_URL = "jdbc:mysql://localhost:3306/xunta_galicia_axudas";
	private static final String USERNAME = "root";
	private static final String PASSWORD = "3270Clb20616!";
	
	public static void main(String args[]) {
		Connection con = null;
		
		try {
		
			con = DriverManager.getConnection(DATABASE_URL, USERNAME, PASSWORD);
			System.out.println("Database Connected");
			PreparedStatement ps = null;
			Statement statement = con.createStatement();
			ResultSet set = statement.executeQuery("Select * from datos");
			while (set.next()) {
				String dni = set.getString("dni");
				String nombre = set.getString("nombre");
				System.out.println("Dni :"+dni+"Nombre :"+nombre);
			}
			set.close();
			statement.close();
		} catch (SQLException e) {
			e.printStackTrace();
			System.out.println("Database Error");
		} finally {
			if (con != null) {
				try {
					con.close();
					System.out.println("Database close");
				} catch (SQLException e) {
					// TODO Auto-generated catch block
					e.printStackTrace();
					System.out.println("Fail Close DB");
				}
			}
		}
		
		
	}

}
